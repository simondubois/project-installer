---

- name: Get composer.json file info
  stat:
    path: "{{ git_destination }}/composer.json"
  register: composer_file

- name: Get public folder info
  stat:
    path: "{{ git_destination }}/public"
  register: public_folder

- name: Set analyze results
  set_fact:
    with_php: "{{ composer_file.stat.exists }}"
    with_composer: "{{ composer_file.stat.exists }}"
    with_apache: "{{ public_folder.stat.exists and public_folder.stat.isdir }}"
    public_path: "{{ public_folder.stat.path }}"
    hostname: "{{ git_repository | basename | regex_replace('.git$', '') }}.dev"
